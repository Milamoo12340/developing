import { base44 } from "@/api/base44Client";

export default async function convertPython(request) {
  const { python } = request.query;
  
  if (!python) {
    return {
      status: 400,
      body: 'ERROR: Missing python parameter'
    };
  }

  try {
    const response = await base44.integrations.Core.InvokeLLM({
      prompt: `Convert the following Python code to AutoHotkey v2 syntax. Maintain the same functionality and logic. Provide clear comments for each section.

Python Code:
\`\`\`python
${decodeURIComponent(python)}
\`\`\`

Return ONLY the AutoHotkey code without any explanations.`,
      response_json_schema: {
        type: "object",
        properties: {
          ahk_code: { type: "string" }
        }
      }
    });

    return {
      status: 200,
      headers: { 'Content-Type': 'text/plain' },
      body: response.ahk_code || 'ERROR: Conversion failed'
    };
  } catch (error) {
    return {
      status: 500,
      body: 'ERROR: ' + error.message
    };
  }
}
